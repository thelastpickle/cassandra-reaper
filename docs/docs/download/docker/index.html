<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.115.2">
    <meta name="description" content="Easy Repair Management for Apache Cassandra">
<meta name="author" content="The Last Pickle">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Docker :: Reaper: Easy Repair Management for Apache Cassandra</title>

    
    <link href="/css/nucleus.css?1749635473" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1749635473" rel="stylesheet">
    <link href="/css/hybrid.css?1749635473" rel="stylesheet">
    <link href="/css/featherlight.min.css?1749635473" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1749635473" rel="stylesheet">
    <link href="/css/auto-complete.css?1749635473" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1749635473" rel="stylesheet">
    <link href="/css/theme.css?1749635473" rel="stylesheet">
    <link href="/css/tabs.css?1749635473" rel="stylesheet">
    <link href="/css/hugo-theme.css?1749635473" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1749635473"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/download/docker/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/' style="text-decoration: none;">
  <span style="color: white; font-size: 36px; font-weight: bold; font-family: Arial, sans-serif;">Reaper</span>
</a> 
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1749635473"></script>
<script type="text/javascript" src="/js/auto-complete.js?1749635473"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/cassandra-reaper.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1749635473"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/docs/" title="Documentation" class="dd-item
        parent
        
        
        ">
      <a href="/docs/">
          Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/concepts/" title="Core Concepts" class="dd-item ">
        <a href="/docs/concepts/">
        Core Concepts
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs/download/" title="Downloads" class="dd-item
        parent
        
        
        ">
      <a href="/docs/download/">
          Downloads
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/download/install/" title="Install and Run" class="dd-item ">
        <a href="/docs/download/install/">
        Install and Run
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/download/building/" title="Building from Source" class="dd-item ">
        <a href="/docs/download/building/">
        Building from Source
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/download/docker/" title="Docker" class="dd-item active">
        <a href="/docs/download/docker/">
        Docker
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs/backends/" title="Backends" class="dd-item
        
        
        
        ">
      <a href="/docs/backends/">
          Backends
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/backends/memory/" title="Local Backend" class="dd-item ">
        <a href="/docs/backends/memory/">
        Local Backend
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/backends/cassandra/" title="Cassandra Backend" class="dd-item ">
        <a href="/docs/backends/cassandra/">
        Cassandra Backend
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs/configuration/" title="Configuration Reference" class="dd-item
        
        
        
        ">
      <a href="/docs/configuration/">
          Configuration Reference
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/configuration/reaper_specific/" title="Reaper Specific Settings" class="dd-item ">
        <a href="/docs/configuration/reaper_specific/">
        Reaper Specific Settings
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/configuration/backend_specific/" title="Backend Specific Settings" class="dd-item ">
        <a href="/docs/configuration/backend_specific/">
        Backend Specific Settings
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/configuration/docker_vars/" title="Docker Variables" class="dd-item ">
        <a href="/docs/configuration/docker_vars/">
        Docker Variables
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/configuration/authentication/" title="Authentication" class="dd-item ">
        <a href="/docs/configuration/authentication/">
        Authentication
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs/metrics/" title="Metrics" class="dd-item
        
        
        
        ">
      <a href="/docs/metrics/">
          Metrics
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/metrics/dashboards/" title="Dashboards" class="dd-item ">
        <a href="/docs/metrics/dashboards/">
        Dashboards
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/metrics/graphite/" title="Graphite Reporter" class="dd-item ">
        <a href="/docs/metrics/graphite/">
        Graphite Reporter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/metrics/prometheus/" title="Prometheus" class="dd-item ">
        <a href="/docs/metrics/prometheus/">
        Prometheus
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/docs/usage/" title="Using Reaper" class="dd-item
        
        
        
        ">
      <a href="/docs/usage/">
          Using Reaper
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/add_cluster/" title="Adding a Cluster" class="dd-item ">
        <a href="/docs/usage/add_cluster/">
        Adding a Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/health/" title="Checking a Cluster&#39;s Health" class="dd-item ">
        <a href="/docs/usage/health/">
        Checking a Cluster&#39;s Health
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/single/" title="Running a Cluster Repair" class="dd-item ">
        <a href="/docs/usage/single/">
        Running a Cluster Repair
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/schedule/" title="Scheduling a Cluster Repair" class="dd-item ">
        <a href="/docs/usage/schedule/">
        Scheduling a Cluster Repair
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/multi_dc_non-distributed/" title="Multi DCs with One Reaper" class="dd-item ">
        <a href="/docs/usage/multi_dc_non-distributed/">
        Multi DCs with One Reaper
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/multi_dc_distributed/" title="Multi DCs with Multi Reapers" class="dd-item ">
        <a href="/docs/usage/multi_dc_distributed/">
        Multi DCs with Multi Reapers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/usage/sidecar_mode/" title="Sidecar Mode" class="dd-item ">
        <a href="/docs/usage/sidecar_mode/">
        Sidecar Mode
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/api/" title="Rest API" class="dd-item ">
        <a href="/docs/api/">
        Rest API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/community/" title="Community" class="dd-item ">
        <a href="/docs/community/">
        Community
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/docs/development/" title="Development" class="dd-item ">
        <a href="/docs/development/">
        Development
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/thelastpickle/cassandra-reaper"><i class='fab fa-github'></i> GitHub</a>
              </li>
          
              <li>
                  <a class="padding" href="http://cassandra-reaper.io/docs/download/"><i class='fas fa-download'></i> Download</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Reaper for Apache Cassandra</a> > <a href='/docs/'>Documentation</a> > <a href='/docs/download/'>Downloads</a> > Docker
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#docker">Docker</a>
      <ul>
        <li><a href="#building-reaper-docker-image">Building Reaper Docker Image</a>
          <ul>
            <li><a href="#prerequisite">Prerequisite</a></li>
            <li><a href="#building-image">Building Image</a></li>
          </ul>
        </li>
        <li><a href="#docker-hub-image">Docker Hub Image</a></li>
      </ul>
    </li>
    <li><a href="#start-docker-environment">Start Docker Environment</a>
      <ul>
        <li><a href="#using-docker">Using Docker</a>
          <ul>
            <li><a href="#in-memory-backend">In-Memory Backend</a></li>
            <li><a href="#cassandra-backend">Cassandra Backend</a></li>
          </ul>
        </li>
        <li><a href="#using-docker-compose">Using Docker Compose</a>
          <ul>
            <li><a href="#default-settings-environment">Default Settings Environment</a></li>
            <li><a href="#ssl-encrypted-connections-environment">SSL Encrypted Connections Environment</a></li>
          </ul>
        </li>
        <li><a href="#access-the-environment">Access The Environment</a></li>
        <li><a href="#destroying-the-docker-environment">Destroying the Docker Environment</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Docker
            </h1>
          

        


<h1 id="docker">Docker</h1>
<p><a href="https://docs.docker.com/engine/installation/">Docker</a> and <a href="https://docs.docker.com/compose/install/">Docker Compose</a> will need to be installed in order to use the commands in this section.</p>
<h2 id="building-reaper-docker-image">Building Reaper Docker Image</h2>
<h3 id="prerequisite">Prerequisite</h3>
<p>The generation of the Docker image requires that the JAR file be built and placed in the <em>src/packages</em> directory. If the JAR package is missing from the directory then it can built using either the steps in the <a href="building-reaper-packages-with-docker">Docker package build</a> section (above), or in the <a href="/docs/download/building/">Building from Source</a> section.</p>
<h3 id="building-image">Building Image</h3>
<p>To build the Reaper Docker Image which is then added to the local image cache using the <code>cassandra-reaper:latest</code> tag, run the following command from the top level directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mvn -pl src/server/ docker:build -Ddocker.directory<span style="color:#f92672">=</span>src/server/src/main/docker
</span></span></code></pre></div><h2 id="docker-hub-image">Docker Hub Image</h2>
<p>A prebuilt Docker Image is available for download from <a href="https://hub.docker.com/r/thelastpickle/cassandra-reaper/">Docker Hub</a>. The image <code>TAG</code> can be specified when pulling the image from Docker Hub to pull a particular version. Set:</p>
<ul>
<li><code>TAG=master</code> to run Reaper with the latest commits</li>
<li><code>TAG=latest</code> to run Reaper with the latest stable release</li>
</ul>
<p>To pull the image from Docker Hub with a particular tag, run the following command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker pull thelastpickle/cassandra-reaper:<span style="color:#e6db74">${</span>TAG<span style="color:#e6db74">}</span>
</span></span></code></pre></div><h1 id="start-docker-environment">Start Docker Environment</h1>
<h2 id="using-docker">Using Docker</h2>
<p>Reaper can be executed within a Docker container with either an ephemeral memory storage or persistent database.</p>
<h3 id="in-memory-backend">In-Memory Backend</h3>
<p>To launch a Reaper container backed by an In-Memory backend, use the following example with the appropriate JMX authentication settings for the cluster it will manage repairs for.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>TAG<span style="color:#f92672">=</span>latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>REAPER_JMX_AUTH_USERNAME<span style="color:#f92672">=</span>reaperUser
</span></span><span style="display:flex;"><span>REAPER_JMX_AUTH_PASSWORD<span style="color:#f92672">=</span>reaperPass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Authentication credentials (required for security)</span>
</span></span><span style="display:flex;"><span>REAPER_AUTH_USER<span style="color:#f92672">=</span>admin
</span></span><span style="display:flex;"><span>REAPER_AUTH_PASSWORD<span style="color:#f92672">=</span>your-secure-admin-password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker run <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -p 8080:8080 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -p 8081:8081 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_JMX_AUTH_USERNAME=</span><span style="color:#e6db74">${</span>REAPER_JMX_AUTH_USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_JMX_AUTH_PASSWORD=</span><span style="color:#e6db74">${</span>REAPER_JMX_AUTH_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_AUTH_USER=</span><span style="color:#e6db74">${</span>REAPER_AUTH_USER<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_AUTH_PASSWORD=</span><span style="color:#e6db74">${</span>REAPER_AUTH_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    thelastpickle/cassandra-reaper:<span style="color:#e6db74">${</span>TAG<span style="color:#e6db74">}</span>
</span></span></code></pre></div><p>Then visit the the Reaper UI: <a href="http://localhost:8080/webui/">http://localhost:8080/webui/</a>.</p>
<h3 id="cassandra-backend">Cassandra Backend</h3>
<p>To launch a Reaper container backed by Cassandra, use the following example to connect to a Cassandra cluster that already has the <code>reaper_db</code> keyspace. Set the appropriate JMX authentication settings for the cluster that Reaper will manage repairs for.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>TAG<span style="color:#f92672">=</span>latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>REAPER_JMX_AUTH_USERNAME<span style="color:#f92672">=</span>reaperUser
</span></span><span style="display:flex;"><span>REAPER_JMX_AUTH_PASSWORD<span style="color:#f92672">=</span>reaperPass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Authentication credentials (required for security)</span>
</span></span><span style="display:flex;"><span>REAPER_AUTH_USER<span style="color:#f92672">=</span>admin
</span></span><span style="display:flex;"><span>REAPER_AUTH_PASSWORD<span style="color:#f92672">=</span>your-secure-admin-password
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>REAPER_CASS_CLUSTER_NAME<span style="color:#f92672">=</span>reaper-cluster
</span></span><span style="display:flex;"><span>REAPER_CASS_CONTACT_POINTS<span style="color:#f92672">={</span><span style="color:#ae81ff">\&#34;</span>host<span style="color:#ae81ff">\&#34;</span>: <span style="color:#ae81ff">\&#34;</span>192.168.2.185<span style="color:#ae81ff">\&#34;</span>, <span style="color:#ae81ff">\&#34;</span>port<span style="color:#ae81ff">\&#34;</span>: <span style="color:#ae81ff">\&#34;</span>9042<span style="color:#ae81ff">\&#34;</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker run <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -p 8080:8080 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -p 8081:8081 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_JMX_AUTH_USERNAME=</span><span style="color:#e6db74">${</span>REAPER_JMX_AUTH_USERNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_JMX_AUTH_PASSWORD=</span><span style="color:#e6db74">${</span>REAPER_JMX_AUTH_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_AUTH_USER=</span><span style="color:#e6db74">${</span>REAPER_AUTH_USER<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_AUTH_PASSWORD=</span><span style="color:#e6db74">${</span>REAPER_AUTH_PASSWORD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_STORAGE_TYPE=cassandra&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_CASS_CLUSTER_NAME=</span><span style="color:#e6db74">${</span>REAPER_CASS_CLUSTER_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_CASS_CONTACT_POINTS=</span><span style="color:#e6db74">${</span>REAPER_CASS_CONTACT_POINTS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -e <span style="color:#e6db74">&#34;REAPER_CASS_KEYSPACE=reaper_db&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    thelastpickle/cassandra-reaper:<span style="color:#e6db74">${</span>TAG<span style="color:#e6db74">}</span>
</span></span></code></pre></div><p>Then visit the the Reaper UI: <a href="http://localhost:8080/webui/">http://localhost:8080/webui/</a>.</p>
<h2 id="using-docker-compose">Using Docker Compose</h2>
<p>The Docker Compose services available allow for orchestration of an environment that uses Reaper&rsquo;s default settings. This provides a quick way to start Reaper and become familiar with its usage without the need of additional infrastructure. The environment created using Docker Compose comprises a single containerised Apache Cassandra node and a single containerised Reaper service.</p>
<p>In addition to the environment using Reaper&rsquo;s default settings, Docker Compose services are provided that allow orchestration of an environment in which the connections between Reaper and Cassandra are SSL encrypted. The services which create this environment contain a <code>-ssl</code> suffix in their name.</p>
<p>It is also possible to automate registering the Cassandra cluster with Reaper and making Reaper start repairing non-system keyspaces automatically. To register a cluster, run the Reaper image with the <code>register-cluster</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>  <span style="color:#f92672">register-clusters</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">cassandra-reaper:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">links</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">cassandra</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">reaper-in-memory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: [<span style="color:#e6db74">&#34;register-clusters&#34;</span>, <span style="color:#e6db74">&#34;cassandra:7199&#34;</span>, <span style="color:#e6db74">&#34;reaper-in-memory&#34;</span>, <span style="color:#e6db74">&#34;8080&#34;</span>]
</span></span></code></pre></div><p>The <code>register-clusters</code> arguments are:</p>
<ul>
<li><code>cassandra:7199</code> - host and (JMX) port of a node in the cluster we want to register.</li>
<li><code>reaper-in-memory</code> - hostname of the Reaper instance.</li>
<li><code>8080</code> - the port on which Reaper listens on.</li>
</ul>
<p>To make Reaper automatically start repairs, make sure the following environment variables are set:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>REAPER_AUTO_SCHEDULING_ENABLED<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;True&#34;</span>
</span></span><span style="display:flex;"><span>REAPER_AUTO_SCHEDULING_TIME_BEFORE_FIRST_SCHEDULE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;PT1M&#34;</span>
</span></span><span style="display:flex;"><span>REAPER_AUTO_SCHEDULING_PERIOD_BETWEEN_POLLS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;PT1M&#34;</span>
</span></span></code></pre></div><p>All available Docker Compose services can be found in the <a href="https://github.com/thelastpickle/cassandra-reaper/blob/master/src/packaging/docker-compose.yml">docker-compose.yml</a> file.</p>
<h3 id="default-settings-environment">Default Settings Environment</h3>
<p>From the top level directory change to the <em>src/packaging</em> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd src/packaging
</span></span></code></pre></div><p>Start the Cassandra cluster:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up cassandra
</span></span></code></pre></div><p>The <code>nodetool</code> Docker Compose service can be used to check on the Cassandra node&rsquo;s status:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run nodetool status
</span></span></code></pre></div><p>You can alternatively attach directly to the Cassandra container and run <code>nodetool status</code> from within it by running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose exec cassandra /bin/bash
</span></span></code></pre></div><p>Now that you have a bash shell in the container, you can run <code>nodetool -u reaperUser -pwf /etc/cassandra/jmxremote.password</code>.</p>
<p>Once the Cassandra node is online and accepting CQL connections, create the required <code>reaper_db</code> Cassandra keyspace to allow Reaper to save its cluster and scheduling data.</p>
<p>By default, the <code>reaper_db</code> keyspace is created using a replication factor of 1. To change this replication factor, provide the intended replication factor as an optional argument:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run cqlsh-initialize-reaper_db <span style="color:#f92672">[</span>$REPLICATION_FACTOR<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Wait a few moments for the <code>reaper_db</code> schema change to propagate, then start Reaper:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up reaper
</span></span></code></pre></div><h3 id="ssl-encrypted-connections-environment">SSL Encrypted Connections Environment</h3>
<p>From the top level directory change to the <em>src/packaging</em> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd src/packaging
</span></span></code></pre></div><p>Generate the SSL Keystore and Truststore which will be used to encrypt the connections between Reaper and Cassandra.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run generate-ssl-stores
</span></span></code></pre></div><p>Start the Cassandra cluster which encrypts both the JMX and Native Protocol:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up cassandra-ssl
</span></span></code></pre></div><p>The <code>nodetool-ssl</code> Docker Compose service can be used to check on the Cassandra node&rsquo;s status:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run nodetool-ssl status
</span></span></code></pre></div><p>Once the Cassandra node is online and accepting encrypted SSL connections via the Native Transport protocol, create the required <code>reaper_db</code> Cassandra keyspace to allow Reaper to save its cluster and scheduling data.</p>
<p>By default, the <code>reaper_db</code> keyspace is created using a replication factor of 1. To change this replication factor, provide the intended replication factor as an optional argument:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run cqlsh-initialize-reaper_db-ssl <span style="color:#f92672">[</span>$REPLICATION_FACTOR<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Wait a few moments for the <code>reaper_db</code> schema change to propagate, then start the Reaper service that will establish encrypted connections to Cassandra:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up reaper-ssl
</span></span></code></pre></div><h2 id="access-the-environment">Access The Environment</h2>
<p>Once started, the UI can be accessed through:</p>
<p>http://127.0.0.1:8080/webui/</p>
<p>A <code>nodetool</code> Docker Compose service is included for both the default and SSL encrypted environments to allow <code>nodetool</code> commands to be performed on Cassandra.</p>
<p>For the <strong>default</strong> environment use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run nodetool status
</span></span></code></pre></div><p>For the <strong>SSL encrypted</strong> environment use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run nodetool-ssl status
</span></span></code></pre></div><p>When adding the Cassandra node to the Reaper UI with the IP address, the above commands can be used to find the node IP address.
You can also add the Cassandra node to the Reaper UI by hostname. The container&rsquo;s hostname is the docker-compose service name.</p>
<p>A <code>cqlsh</code> Docker Compose service is included as well for both the default and SSL encrypted environments to allow the creation of user tables in Cassandra.</p>
<p>For the <strong>default</strong> environment use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run cqlsh
</span></span></code></pre></div><p>For the <strong>SSL encrypted</strong> environment use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose run cqlsh-ssl
</span></span></code></pre></div><h2 id="destroying-the-docker-environment">Destroying the Docker Environment</h2>
<p>When terminating the infrastructure, use the following command to stop
all related Docker Compose services:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose down
</span></span></code></pre></div><p>To completely clean up all persistent data, delete the <code>./data/</code> directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm -rf ./data/
</span></span></code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/docs/download/building/" title="Building from Source"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/backends/" title="Backends" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1749635473"></script>
    <script src="/js/perfect-scrollbar.min.js?1749635473"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1749635473"></script>
    <script src="/js/jquery.sticky.js?1749635473"></script>
    <script src="/js/featherlight.min.js?1749635473"></script>
    <script src="/js/highlight.pack.js?1749635473"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1749635473"></script>
    <script src="/js/learn.js?1749635473"></script>
    <script src="/js/hugo-learn.js?1749635473"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

