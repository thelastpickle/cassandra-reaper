<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.2" />
    <meta name="description" content="Cassandra Reaper documentation">


    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
    <title>perating Multiple DCs using Multiple Reaper :: Reaper: Easy Repair Management for Apache Cassandra</title>

    
    <link href="/css/nucleus.css?1598595356" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1598595356" rel="stylesheet">
    <link href="/css/hybrid.css?1598595356" rel="stylesheet">
    <link href="/css/featherlight.min.css?1598595356" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1598595356" rel="stylesheet">
    <link href="/css/auto-complete.css?1598595356" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1598595356" rel="stylesheet">
    <link href="/css/theme.css?1598595356" rel="stylesheet">
    <link href="/css/hugo-theme.css?1598595356" rel="stylesheet">
    
    <link href="/css/theme-mine.css?1598595356" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1598595356"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/usage/multi_dc_distributed/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/"><img src="/img/logo.png"  alt="Reaper logo"></a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1598595356"></script>
<script type="text/javascript" src="/js/auto-complete.js?1598595356"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/cassandra-reaper.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1598595356"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/concepts/" title="Core Concepts" class="dd-item 
        
        
        
        ">
      <a href="/concepts/">
          Core Concepts
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/install/" title="Install and Run" class="dd-item 
        
        
        
        ">
      <a href="/install/">
          Install and Run
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/install/install/" title="Package Install Guide" class="dd-item ">
        <a href="/install/install/">
        Package Install Guide
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/install/docker/" title="Docker Guide" class="dd-item ">
        <a href="/install/docker/">
        Docker Guide
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/install/upgrade/" title="Upgrade Guide" class="dd-item ">
        <a href="/install/upgrade/">
        Upgrade Guide
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/backends/" title="Backend Options" class="dd-item 
        
        
        
        ">
      <a href="/backends/">
          Backend Options
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/backends/memory/" title="In-Memory Backend" class="dd-item ">
        <a href="/backends/memory/">
        In-Memory
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/backends/h2/" title="H2 Backend" class="dd-item ">
        <a href="/backends/h2/">
        H2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/backends/postgres/" title="Postgres Backend" class="dd-item ">
        <a href="/backends/postgres/">
        Postgres
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/backends/cassandra/" title="Cassandra Backend" class="dd-item ">
        <a href="/backends/cassandra/">
        Cassandra
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/usage/" title="Using Reaper" class="dd-item 
        parent
        
        
        ">
      <a href="/usage/">
          Using Reaper
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/usage/add_cluster/" title="Adding a Cluster" class="dd-item ">
        <a href="/usage/add_cluster/">
        Adding a Cluster
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/health/" title="Checking a Cluster&#39;s Health" class="dd-item ">
        <a href="/usage/health/">
        Checking a Cluster&#39;s Health
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/single/" title="Running a Cluster Repair" class="dd-item ">
        <a href="/usage/single/">
        Running a Cluster Repair
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/schedule/" title="Scheduling a Cluster Repair" class="dd-item ">
        <a href="/usage/schedule/">
        Scheduling a Cluster Repair
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/multi_dc_non-distributed/" title="Operating Multiple DCs with a Single Reaper" class="dd-item ">
        <a href="/usage/multi_dc_non-distributed/">
        Multi DCs with One Reaper
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/multi_dc_distributed/" title="perating Multiple DCs using Multiple Reaper" class="dd-item active">
        <a href="/usage/multi_dc_distributed/">
        Multi DCs with Multi Reapers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/sidecar_mode/" title="Sidecar Mode" class="dd-item ">
        <a href="/usage/sidecar_mode/">
        Sidecar Mode
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/usage/cassandra-diagnostics/" title="Cassandra Diagnostic Events" class="dd-item ">
        <a href="/usage/cassandra-diagnostics/">
        Cassandra Diagnostic Events
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/configuration/" title="Configuration Reference" class="dd-item 
        
        
        
        ">
      <a href="/configuration/">
          Configuration Reference
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/configuration/reaper_specific/" title="Reaper Specific Settings" class="dd-item ">
        <a href="/configuration/reaper_specific/">
        Reaper Specific Settings
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/configuration/backend_specific/" title="Backend Specific Settings" class="dd-item ">
        <a href="/configuration/backend_specific/">
        Backend Specific Settings
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/configuration/docker_vars/" title="Docker Variables" class="dd-item ">
        <a href="/configuration/docker_vars/">
        Docker Variables
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/configuration/authentication/" title="Authentication" class="dd-item ">
        <a href="/configuration/authentication/">
        Authentication
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/metrics/" title="Metrics Reporting" class="dd-item 
        
        
        
        ">
      <a href="/metrics/">
          Metrics Reporting
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/metrics/graphite/" title="Graphite Reporter" class="dd-item ">
        <a href="/metrics/graphite/">
        Graphite Reporter
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/development/" title="Developer Resources" class="dd-item 
        
        
        
        ">
      <a href="/development/">
          Developer Resources
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/development/building/" title="Build from Source" class="dd-item ">
        <a href="/development/building/">
        Build from Source
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/merging/" title="Forward Merging" class="dd-item ">
        <a href="/development/merging/">
        Forward Merging
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/releases/" title="Cutting a Release" class="dd-item ">
        <a href="/development/releases/">
        Cutting a Release
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/api/" title="REST API" class="dd-item ">
        <a href="/development/api/">
        REST API
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://cassandra-reaper.io/downloads"><i class='fas fa-download'></i> Downloads</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/thelastpickle/cassandra-reaper"><i class='fab fa-fw fa-github'></i> GitHub repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://cassandra-reaper.io/community"><i class='fas fa-comments'></i> Community</a>
              </li>
          
              <li> 
                  <a class="padding" href="http://cassandra-reaper.io/faq"><i class='fas fa-question-circle'></i> FAQ</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Cassandra Reaper</a> > <a href='/usage/'>Using Reaper</a> > perating Multiple DCs using Multiple Reaper
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#multiple-reaper-instances-with-jmx-accessible-for-all-dcs">Multiple Reaper instances with JMX accessible for all DCs</a></li>
    <li><a href="#multiple-reaper-instances-with-jmx-accessible-for-limited-dcs">Multiple Reaper instances with JMX accessible for limited DCs</a></li>
    <li><a href="#multiple-reaper-instances-with-jmx-accessible-locally-to-each-dc">Multiple Reaper instances with JMX accessible locally to each DC</a></li>
    <li><a href="#multiple-reaper-instances-with-jmx-access-restricted-to-localhost">Multiple Reaper instances with JMX access restricted to localhost</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              perating Multiple DCs using Multiple Reaper
            </h1>
          

        


<p>Multiple Reaper instances can operate clusters which have multi datacenter deployment. Multiple Reaper instances, also known as Distributed mode, can only be used when using the Apache Cassandra backend. Using multiple Reaper instances allows improved availability and fault tolerance. It is more likely that a Reaper UI is available via one of the Reaper instances, and that scheduled repairs are executed by one of the running Reaper instances.</p>
<p>The <code>datacenterAvailability</code> setting in the Reaper YAML file indicates to Reaper its deployment in relation to cluster data center network locality.</p>
<h2 id="multiple-reaper-instances-with-jmx-accessible-for-all-dcs">Multiple Reaper instances with JMX accessible for all DCs</h2>
<p>In the case where the JMX port is accessible (with or without authentication) from the running Reaper instance for all nodes in all DCs, it is possible to have multiple instances of Reaper handle one or multiple clusters by using the following setting in the configuration yaml file :</p>
<pre><code>datacenterAvailability: ALL
</code></pre><div class = "row">
    <div class = "col-md-6">
        <a data-fancybox="gallery" href="/img/singlereaper_multidc_all.png">
        <img src="/img/singlereaper_multidc_all.png" class="img-responsive">
        </a>
    </div>
    <div>
        <h4></h4>

        
    </div>

</div>







<p>Reaper must be able to access the JMX port (7199 by default) and port 9042 if the cluster is also used as Cassandra backend, on the local DC.</p>
<h2 id="multiple-reaper-instances-with-jmx-accessible-for-limited-dcs">Multiple Reaper instances with JMX accessible for limited DCs</h2>
<p>In the case where the JMX port is accessible (with or without authentication) from the running Reaper instance for all nodes in only some of the DCs, it is possible to have multiple instances of Reaper handle one or multiple clusters by using the following setting in the configuration yaml file :</p>
<pre><code>datacenterAvailability: LOCAL
</code></pre><p>Note, there is no backpressure for nodes in any datacenter if no Reaper instances have JMX access to that datacenter. This is because the JMX metrics (pending compactions, running repairs) required for backpressure is not available from those remote nodes.</p>
<p>If multiple clusters are registered in Reaper it is required that some Reaper instances can access all the nodes in at least one of the datacenters in each of the registered clusters.</p>
<p><code>LOCAL</code> mode allows you to register multiple clusters in a distributed Reaper installation. <code>LOCAL</code> mode also allows you to prioritize repairs running according to their schedules over worrying about the load on remote and unaccessible datacenters and nodes.</p>
<div class = "row">
    <div class = "col-md-6">
        <a data-fancybox="gallery" href="/img/singlereaper_multidc_local.png">
        <img src="/img/singlereaper_multidc_local.png" class="img-responsive">
        </a>
    </div>
    <div>
        <h4></h4>

        
    </div>

</div>







<p>Reaper must be able to access the JMX port (7199 by default) and port 9042 if the cluster is also used as Cassandra backend, on the local DC.</p>
<p>Any keyspaces that only have replicas in remote JMX unreachable datacenters can not be repaired by Reaper.</p>
<h2 id="multiple-reaper-instances-with-jmx-accessible-locally-to-each-dc">Multiple Reaper instances with JMX accessible locally to each DC</h2>
<p>In the case where the JMX port is accessible (with or without authentication) from the running Reaper instance for all nodes in the current DC only, it is possible to have a multiple instances of Reaper running in different DCs by using the following setting in the configuration yaml file:</p>
<pre><code>datacenterAvailability: EACH
</code></pre><p>This setup prioritises handling backpressure on all nodes over running repairs. Where latency of requests and availability of nodes takes precedence over scheduled repairs this is the safest setup in Reaper.</p>
<p>There must be installed and running a Reaper instance in every datacenter of every registered Cassandra cluster. And every Reaper instance must have CQL access to the backend Cassandra cluster it uses as a backend.</p>
<div class = "row">
    <div class = "col-md-6">
        <a data-fancybox="gallery" href="/img/multireaper_multidc.png">
        <img src="/img/multireaper_multidc.png" class="img-responsive">
        </a>
    </div>
    <div>
        <h4></h4>

        
    </div>

</div>







<p>Reaper must be able to access the JMX port (7199 by default) and port 9042 if the cluster is also used as Cassandra backend, on the local DC.</p>
<h2 id="multiple-reaper-instances-with-jmx-access-restricted-to-localhost">Multiple Reaper instances with JMX access restricted to localhost</h2>
<p>By default, Cassandra starts up with JMX access restricted to the local machine. This is considered by many companies as being a security requirement. In this case, one reaper instance must be collocated as a sidecar with each Cassandra process, using the following setting in the configuration yaml file:</p>
<pre><code>datacenterAvailability: SIDECAR
</code></pre><p>There must be installed and running a Reaper instance on each Cassandra node in the cluster. And every Reaper instance must have CQL access to the backend Cassandra cluster it uses as a backend.</p>
<div class = "row">
    <div class = "col-md-6">
        <a data-fancybox="gallery" href="/img/sidecar_mode.png">
        <img src="/img/sidecar_mode.png" class="img-responsive">
        </a>
    </div>
    <div>
        <h4></h4>

        
    </div>

</div>







<p>Reaper must be able to access the JMX port (7199 by default) and port 9042 if the cluster is also used as Cassandra backend, on the local DC.</p>
<p>More informations on the sidecar mode can be found on <a href="/usage/sidecar_mode/">this page</a>.</p>


<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1598595356"></script>
    <script src="/js/perfect-scrollbar.min.js?1598595356"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1598595356"></script>
    <script src="/js/jquery.sticky.js?1598595356"></script>
    <script src="/js/featherlight.min.js?1598595356"></script>
    <script src="/js/highlight.pack.js?1598595356"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1598595356"></script>
    <script src="/js/learn.js?1598595356"></script>
    <script src="/js/hugo-learn.js?1598595356"></script>

    <link href="/mermaid/mermaid.css?1598595356" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1598595356"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

